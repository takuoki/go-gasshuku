#### 「Go言語によるWebアプリケーション開発（１章）」
#### を読んでみた

@takuoki

---

### 自己紹介

沖　卓生
@takuoki

ベルトラ株式会社

---

### 作成するアプリケーション

* チャットアプリケーション
* テキスト入力 → 他の人も見れる
* チャットルーム入室時、WebSocketを接続（退室時Close）
* WebSocketなので、リアルタイム反映（リロード不要）

---

### 概要

* ブラウザからWebSocketを通して送信されるメッセージを受ける子が必要
* ブラウザから受けたメッセージを皆にブロードキャストしてくれる子が必要
* ブロードキャストされたメッセージをWebSocketを通してブラウザに送信する子が必要

* クライアントそれぞれがWebSocketを持つ
* クライアントを管理する「チャットルーム」
* クライアントがメッセージを送信したら、チャットルーム内のすべてのクライアントに送信

---

### クライアント

* ブラウザとの通信はWebSocket
* 内部の他のgoroutineとのやり取りはChannel
* デーモンのように動き続ける処理が２つ
  * read: WebSocketの受信
  * write: WebSocketの送信

---

### チャットルーム

* 入室したらクライアントを追加（退室したら削除）
* クライアントからメッセージが送信されてきたら、今いるクライアントにブロードキャスト

---

### 感想

* goroutineって、ループの中の処理を切り出すくらいの使い方しかやったことない
* 小さなワーカーを立てて、Channelでやり取りするAppを理解するという意味では、とても良いサンプル
* ただ、第１章からWebSocketのアプリは、ちょっと重いかも

---

### おわりに

* `veltra engineering` Blog
* `try golang`
